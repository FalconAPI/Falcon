<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/cadastrar.css">
    <link rel="shortcut icon" href="../fotos/falcon-favicon.png" type="image/x-icon">
    <script type="text\javascript" src="/eel.js"></script>
    <title>Cadastro</title>
</head>
<body>  
    <div class="barra-home">
        <div class="logo-home">
            <img src="../fotos/logo_falcon_200.png" alt="logo_falcon_200" width="150px" height="150px">
        </div>
        <div class="nome-home" id="nome_home"></div>
        <div class="bt-home">
            <button class="bt-voltar" onclick="go_to('menu.html')">Voltar</button>
            <button class="bt-sair" onclick="go_to('login.html')">Sair</button>
        </div>
    </div> 
    <div class="main-cad">
        <div class="left-cad">
            <div class="botoes">
                <h1>CADASTRO</h1>
                <button class="botao-cadastrar" id="btnTurma" onclick="Esconder_tudo_menos_id('cdTurma')">CADASTRAR TURMA</button>
                <button class="botao-cadastrar" id="btnTime" onclick="Esconder_tudo_menos_id('cdTime')">CADASTRAR TIME</button>
                <button class="botao-cadastrar" id="btnUsuario" onclick="Esconder_tudo_menos_id('cdUsuario')">CADASTRAR USUÁRIO</button>
                <button class="botao-cadastrar" id="btnSprint" onclick="Esconder_tudo_menos_id('cdSprint')">CADASTRAR SPRINT</button>
            </div>
        </div>
        <div class="right-cad">
            <div class="cadastrar-turma" id="cdTurma">
                <h1>CADASTRAR TURMA</h1>
                <div class="textfield">
                    <label for="nome">Nome da Turma</label>
                    <input type="text" id="cadastrar-turma" name="Turma123">
                </div>
                <div class="bt-cancelar-salvar">
                    <button class="bt-cancelar-salvar" id="bt-cancelar" onclick="cancelaA()">Cancelar</button>
                    <button class="bt-cancelar-salvar" id="bt-salvar" onclick="cadTurma()">Salvar</button>
                </div>
            </div>
            <div class="cadastrar-time" id="cdTime">
                <h1>CADASTRAR TIME</h1>
                <div class="textfield">
                    <label for="turma">Escolha a turma que o instrutor pertence:</label>
                    <select class="textfield-turma" name="turma" id="selectTurma">
                    </select>
                </div>
                <div class="textfield">
                    <label for="nome">Nome do Time</label>
                    <input type="text" id="timeCad" name="Time">
                </div>
                <div class="bt-cancelar-salvar">
                    <button class="bt-cancelar-salvar" id="bt-cancelar" onclick="cancelaC()">Cancelar</button>
                    <button class="bt-cancelar-salvar" id="bt-salvar" onclick="cadTime()">Salvar</button>
                </div>
            </div>    
            <div class="cadastrar-usuario" id="cdUsuario">
                <h1>CADASTRAR USUÁRIO</h1>
                <div class="test">
                    <label for="cargo">Cargo:</label>
                    <select class="textfield-cargo" name="cargo" id="cargo" onchange="mostraValor(this.value)">
                        <option value="Desenvolvedor">Desenvolvedor</option>
                        <option value="Product Owner">Product Owner</option>
                        <option value="Scrum Master">Scrum Master</option>
                        <option value="Fake Client">Fake Client</option>
                        <option value="Instrutor">Instrutor</option>
                    </select>
                </div>
                <div class="test" id="turma">
                    <label for="turma">Escolha a turma que o usuário pertence:</label>
                    <select class="textfield-turma" id="turma-usuario" nome="turma">
                    </select>
                </div>
                <div class="test1" id="time">
                    <label for="time">Escolha o time que pertence:</label>
                    <select class="textfield-time" id="time-usuario" name="time" >
                        <option value="None"></option>
                    </select>
                </div>
                <div class="textfield">
                    <label for="nome">Nome:</label>
                    <input type="text" id="usuário" name="Usuário">
                </div>
                <div class="textfield">
                    <label for="email">E-mail:</label>
                    <input type="email" name="Email" id="email">
                </div>
                <div class="textfield">
                    <label for="senha-do-usuário">Crie uma senha:</label>
                    <input type="text" id="senha-do-usuário">
                </div>
                <div class="bt-cancelar-salvar">
                    <button class="bt-cancelar-salvar" id="bt-cancelar" onclick="cancelaD()">Cancelar</button>
                    <button class="bt-cancelar-salvar" id="bt-salvar" onclick="cadUsuario()">Salvar</button>
                </div>
            </div>    
            <div class="cadastrar-sprint" id="cdSprint">
                <h1>CADASTRAR SPRINT</h1>
                <div class="test2" id="usuario">
                    <label for="turma">Escolha a turma que pertence:</label>
                    <select class="textfield-turma" id="turma-usuario" nome="turma">
                    </select>
                </div>
                <div class="textfield-sprint">
                    <label for="nome">Coloque as datas de início e fim da Sprint</label>
                    <div class="datas">      
                        <div class="datas-início">
                            <label for="início">Início:</label>
                            <input type="date" id="sprint-inicio" name="Sprint" required>
                            <span class="validity"></span>        
                        </div>
                        <div class="datas-fim">
                            <label for="fim">Fim:</label>
                            <input type="date" id="sprint-fim" name="Sprint" required>
                            <span class="validity"></span>
                        </div>
                    </div>
                    <button class="bt-add" type="submit">+</button>
                </div>
                <div class="bt-cancelar-salvar">
                    <button class="bt-cancelar-salvar" id="bt-cancelar" onclick="cancelaE()">Cancelar</button>
                    <button class="bt-cancelar-salvar" id="bt-salvar">Salvar</button>
                </div>
            </div>
        </div> 
    </div>
    <script type="text/javascript" src="/eel.js"></script>
    <script>

        function go_to(url) {
            window.location.replace(url);
        }

        function Esconder_elementos(lista_de_id){
            lista_de_id.forEach(function(id){
                document.getElementById(id)
            })
        }

        function Esconder_tudo_menos_id(id){
            let lista_de_todos_id = ['cdTurma', 'cdTime', 'cdUsuario', 'cdSprint']
            lista_de_todos_id.splice(list.indexOf('id'), 1)
            Esconder_elementos(lista_de_todos_id)
        }

        function Adicionar_item(valores, id) {
            Zerar_select(id)
            let select = document.getElementById(id).add(new Option('', ''))
            valores.forEach(function(item){
                let option = new Option(item, item);
                let select = document.getElementById(id);
                select.add(option);
            })
        }

        function Pegar_times(id){
            let turma = document.getElementById(id).value
            eel.Retorna_info('times', turma) (function (result){
                Zerar_select("time-usuario")
                Adicionar_item(result, 'time-usuario')
            })
        }

        function Zerar_select(id){
            let select  = document.getElementById(id)
            select.innerHTML = ''
        }
        
        // Para colocar o nome na Barra de Menu e para esconder os itens de acordo com o cargo
        eel.Retorna_info('user')(function (info_do_usuario){
            var nome_home = document.getElementById('nome_home')
            nome_home.innerHTML = `<h1>${info_do_usuario['Nome']}</h1>`

            if (info_do_usuario['Cargo'] == 'Administrador'){
                Esconder_elementos(['btnTime', 'btnSprint'])
            }

            else{// info_do_usuario['Cargo'] == 'Instrutor'
            Esconder_elementos(['btnTurma'])
            }
        })
        
        eel.Retorna_info('turmas') (function(todas_turmas){
            Adicionar_item(todas_turmas, 'turma-usuario')  // Colocar todas as turmas no Cadastrar Usuario
            Adicionar_item(todas_turmas, 'turma')          // Colocar todas as turmas no Cadastrar Turmas
        })



        select_turma_user = document.getElementById('turma-usuario')
        // Eventos para sempre atualizar os selects         
        select_turma_user.addEventListener('change', function(){
            Pegar_times('turma-usuario')
        })

    </script>
</body>
</html>